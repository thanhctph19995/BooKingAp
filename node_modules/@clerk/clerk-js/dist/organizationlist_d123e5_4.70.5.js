"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[653],{1987:function(t,i,e){e.r(i),e.d(i,{OrganizationList:function(){return _}});var n=e(2903),a=e(5480),o=e(8173),r=e(3476),s=e(3736),l=e(2784),c=e(8690),d=e(8441),u=e(3647),g=e(4804),h=e(9820);const p=t=>(0,n.tZ)(r.Col,{elementDescriptor:r.descriptors.organizationListPreviewItems,sx:t=>({maxHeight:`calc(8 * ${t.sizes.$12})`,overflowY:"auto",...h.common.unstyledScrollbar(t)}),children:t.children}),z=t=>({height:t.space.$12,padding:`${t.space.$2} ${t.space.$8}`}),v=t=>({fontSize:t.fontSizes.$md,fontWeight:t.fontWeights.$normal,color:t.colors.$colorText}),m=t=>(0,n.BX)(r.Flex,{align:"center",gap:2,sx:[t=>({minHeight:"unset",justifyContent:"space-between"}),z],elementDescriptor:r.descriptors.organizationListPreviewItem,children:[(0,n.tZ)(c.OrganizationPreview,{elementId:"organizationList",size:"sm",mainIdentifierSx:v,organization:t.organizationData}),t.children]}),C=(0,l.forwardRef)(((t,i)=>(0,n.tZ)(r.Box,{ref:i,sx:t=>({width:"100%",height:t.space.$12,position:"relative"}),children:(0,n.tZ)(r.Box,{sx:{margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,n.tZ)(r.Spinner,{size:"sm",colorScheme:"primary"})})}))),S=t=>(0,n.tZ)(r.Button,{elementDescriptor:r.descriptors.organizationListPreviewItemActionButton,textVariant:"buttonExtraSmallBold",variant:"outline",colorScheme:"neutral",size:"sm",...t}),L=t=>(0,n.tZ)(c.PreviewButton,{elementDescriptor:r.descriptors.organizationListPreviewButton,sx:[z],icon:g.LZ,iconProps:{size:"md"},showIconOnHover:!1,...t});var w=e(1609),Z=e(1659),x=e(4334);const f=(0,c.withCardStateProvider)((t=>{const i=(0,c.useCardState)(),{navigateAfterSelectOrganization:e}=(0,o.useOrganizationListContext)(),{isLoaded:a,setActive:r}=(0,o.useCoreOrganizationList)();return a?(0,n.tZ)(L,{onClick:()=>{return n=t.organization,i.runAsync((async()=>{await r({organization:n}),await e(n)}));var n},children:(0,n.tZ)(c.OrganizationPreview,{elementId:"organizationList",size:"sm",mainIdentifierSx:v,organization:t.organization})}):null})),$=(0,c.withCardStateProvider)((()=>{const t=(0,c.useCardState)(),{hidePersonal:i,navigateAfterSelectPersonal:e}=(0,o.useOrganizationListContext)(),{isLoaded:a,setActive:r}=(0,o.useCoreOrganizationList)(),s=(0,o.useCoreUser)(),{username:l,primaryEmailAddress:d,primaryPhoneNumber:u,...g}=s;return i?null:(0,n.tZ)(L,{onClick:()=>{if(a)return t.runAsync((async()=>{await r({organization:null}),await e(s)}))},children:(0,n.tZ)(c.PersonalWorkspacePreview,{user:g,size:"sm",mainIdentifierSx:v,title:(0,x.u1)("organizationSwitcher.personalWorkspace")})})})),y={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},P=t=>{const i=(0,c.useCardState)();return(0,n.tZ)(S,{isLoading:i.isLoading,onClick:t.onAccept,localizationKey:(0,r.localizationKeys)("organizationList.action__invitationAccept")})},O=(0,c.withCardStateProvider)((t=>{const i=(0,c.useCardState)(),{getOrganization:e}=(0,o.useCoreClerk)(),[a,r]=(0,l.useState)(null),{userInvitations:s}=(0,o.useCoreOrganizationList)({userInvitations:y.userInvitations});return a?(0,n.tZ)(f,{organization:a}):(0,n.tZ)(m,{organizationData:t.publicOrganizationData,children:(0,n.tZ)(P,{onAccept:()=>i.runAsync((async()=>[await t.accept(),await e(t.publicOrganizationData.id)])).then((([t,i])=>{var e;null===(e=null==s?void 0:s.setData)||void 0===e||e.call(s,(i=>(0,Z.Sz)(t,i))),r(i)})).catch((t=>(0,w.S3)(t,[],i.setError)))})})})),b=t=>{const i=(0,c.useCardState)(),{userSuggestions:e}=(0,o.useCoreOrganizationList)({userSuggestions:y.userSuggestions});return"accepted"===t.status?(0,n.tZ)(r.Text,{variant:"smallRegular",colorScheme:"neutral",localizationKey:(0,r.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,n.tZ)(S,{isLoading:i.isLoading,onClick:()=>i.runAsync(t.accept).then((t=>{var i;return null===(i=null==e?void 0:e.setData)||void 0===i?void 0:i.call(e,(i=>(0,Z.Sz)(t,i)))})).catch((t=>(0,w.S3)(t,[],i.setError))),localizationKey:(0,r.localizationKeys)("organizationList.action__suggestionsAccept")})},I=(0,c.withCardStateProvider)((t=>(0,n.tZ)(m,{organizationData:t.publicOrganizationData,children:(0,n.tZ)(b,{...t})}))),k=()=>{const{userMemberships:t,userInvitations:i,userSuggestions:e}=(0,o.useCoreOrganizationList)(y),{ref:n}=(0,d.YD)({threshold:0,onChange:n=>{var a,o,r;n&&(t.hasNextPage?null===(a=t.fetchNext)||void 0===a||a.call(t):i.hasNextPage?null===(o=i.fetchNext)||void 0===o||o.call(i):null===(r=e.fetchNext)||void 0===r||r.call(e))}});return{userMemberships:t,userInvitations:i,userSuggestions:e,ref:n}},A=(0,c.withCardStateProvider)((()=>{const t=(0,c.useCardState)(),{userMemberships:i,userSuggestions:e,userInvitations:a}=k(),s=(null==i?void 0:i.isLoading)||(null==a?void 0:a.isLoading)||(null==e?void 0:e.isLoading),l=!!((null==i?void 0:i.count)||(null==a?void 0:a.count)||(null==e?void 0:e.count)),{hidePersonal:d}=(0,o.useOrganizationListContext)();return(0,n.BX)(c.Card,{sx:t=>({padding:`${t.space.$8} ${t.space.$none}`}),insideAppLogoSx:t=>({padding:`${t.space.$none} ${t.space.$8}`}),gap:6,children:[(0,n.tZ)(c.CardAlert,{children:t.error}),s&&(0,n.tZ)(r.Flex,{direction:"row",align:"center",justify:"center",sx:t=>({height:"100%",minHeight:t.sizes.$60}),children:(0,n.tZ)(r.Spinner,{size:"lg",colorScheme:"primary"})}),!s&&(0,n.tZ)(D,{showListInitially:!(d&&!l)})]})})),B=(0,c.withCardStateProvider)((t=>{const{showListInitially:i,isCreateOrganizationFlow:e,setCreateOrganizationFlow:a}=t,s=(0,o.useEnvironment)(),{navigateAfterSelectOrganization:l,skipInvitationScreen:c}=(0,o.useOrganizationListContext)();return(0,n.tZ)(n.HY,{children:(0,n.tZ)(r.Box,{sx:t=>({padding:`${t.space.$none} ${t.space.$8}`}),children:(0,n.tZ)(u.$,{flow:"organizationList",skipInvitationScreen:c,startPage:{headerTitle:(0,r.localizationKeys)("createOrganization.title"),headerSubtitle:(0,r.localizationKeys)("organizationList.subtitle",{applicationName:s.displayConfig.applicationName})},navigateAfterCreateOrganization:t=>l(t).then((()=>a(!1))),onCancel:i&&e?()=>a(!1):void 0})})})})),D=({showListInitially:t})=>{const[i,e]=(0,l.useState)(!t);return(0,n.BX)(n.HY,{children:[!i&&(0,n.tZ)(N,{onCreateOrganizationClick:()=>e(!0)}),i&&(0,n.tZ)(B,{isCreateOrganizationFlow:i,setCreateOrganizationFlow:e,showListInitially:t})]})},N=(0,c.withCardStateProvider)((t=>{var i,e,a;const s=(0,c.useCardState)(),l=(0,o.useEnvironment)(),{ref:d,userMemberships:u,userSuggestions:g,userInvitations:h}=k(),{hidePersonal:z}=(0,o.useOrganizationListContext)(),v=(null==u?void 0:u.isLoading)||(null==h?void 0:h.isLoading)||(null==g?void 0:g.isLoading),m=(null==u?void 0:u.hasNextPage)||(null==h?void 0:h.hasNextPage)||(null==g?void 0:g.hasNextPage);return(0,n.BX)(n.HY,{children:[(0,n.tZ)(c.CardAlert,{children:s.error}),(0,n.BX)(c.Header.Root,{sx:t=>({padding:`${t.space.$none} ${t.space.$8}`}),children:[(0,n.tZ)(c.Header.Title,{localizationKey:(0,r.localizationKeys)(z?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,n.tZ)(c.Header.Subtitle,{localizationKey:(0,r.localizationKeys)("organizationList.subtitle",{applicationName:l.displayConfig.applicationName})})]}),(0,n.BX)(r.Col,{elementDescriptor:r.descriptors.main,gap:6,children:[(0,n.BX)(p,{children:[(0,n.tZ)($,{}),(u.count||0)>0&&(null===(i=u.data)||void 0===i?void 0:i.map((t=>(0,n.tZ)(f,{...t},t.id)))),!u.hasNextPage&&(h.count||0)>0&&(null===(e=h.data)||void 0===e?void 0:e.map((t=>(0,n.tZ)(O,{...t},t.id)))),!u.hasNextPage&&!h.hasNextPage&&(g.count||0)>0&&(null===(a=g.data)||void 0===a?void 0:a.map((t=>(0,n.tZ)(I,{...t},t.id)))),(m||v)&&(0,n.tZ)(C,{ref:d})]}),(0,n.tZ)(c.Divider,{sx:t=>({padding:`${t.space.$none} ${t.space.$8}`})},"divider"),(0,n.tZ)(r.Flex,{align:"center",justify:"between",sx:t=>({padding:`${t.space.$none} ${t.space.$8}`}),children:(0,n.tZ)(r.Button,{elementDescriptor:r.descriptors.button,block:!0,colorScheme:"neutral",variant:"outline",textVariant:"buttonExtraSmallBold",onClick:()=>{t.onCreateOrganizationClick()},localizationKey:(0,r.localizationKeys)("organizationList.action__createOrganization")})})]})]})})),K=(0,o.withCoreUserGuard)(A),_=(0,a.pK)((()=>(0,n.tZ)(r.Flow.Root,{flow:"organizationList",children:(0,n.tZ)(r.Flow.Part,{children:(0,n.tZ)(s.Switch,{children:(0,n.tZ)(s.Route,{children:(0,n.tZ)(K,{})})})})})),"OrganizationList",{mode:"redirect"})}}]);